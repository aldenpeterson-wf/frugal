project: frugal
language: golang

# testing
runner_image: drydock.workiva.org/workiva/messaging-docker-images:78017

script:
    - ./scripts/smithy.sh
    # Print out all the test logs as their own section in the smithy report view
    - cat $SMITHY_ROOT/test_results/smithy_dart.sh_out.txt
    - cat $SMITHY_ROOT/test_results/smithy_go.sh_out.txt
    - cat $SMITHY_ROOT/test_results/smithy_generator.sh_out.txt
    - cat $SMITHY_ROOT/test_results/smithy_python.sh_out.txt
    - cat $SMITHY_ROOT/test_results/smithy_java.sh_out.txt

env:
    - FRUGAL_HOME=/smithy-builder/builds/Workiva/frugal/cache/GO/src/github.com/Workiva/frugal # $GOPATH/src/github.com/Workiva/frugal
    - SMITHY_ROOT=/smithy-builder/builds/Workiva/frugal/workspace

artifacts:
    artifactory:
        - frugal-*.jar
    release:
        - /frugal
    go_library:
        - goLib.tar.gz
    pub:
        - frugal.pub.tgz
    pypi:
        - frugal-*.tar.gz
    test_results:
        - test_results/*
